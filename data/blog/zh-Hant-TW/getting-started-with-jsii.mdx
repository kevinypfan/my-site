---
title: JSII å¿«é€Ÿå…¥é–€ï¼šä½¿ç”¨ TypeScript å»ºæ§‹è·¨èªè¨€å‡½å¼åº«
authors: ['kevinfan']
date: '2025-01-04'
tags: ['javascript', 'typescript', 'python', 'golang', 'java', 'csharp', 'jsii', 'aws']
draft: false
summary: 'JSII è®“é–‹ç™¼è€…èƒ½ä½¿ç”¨ TypeScript å»ºæ§‹å‡½å¼åº«ï¼Œä¸¦åœ¨ Pythonã€Javaã€C#ã€Go ç­‰å¤šç¨®èªè¨€ä¸­ç„¡ç¸«é‹è¡Œã€‚æœ¬æ–‡æä¾›äº†è¨­å®š JSII å°ˆæ¡ˆçš„é€æ­¥æ•™å­¸ï¼Œæ¶µè“‹å¤šèªè¨€æ”¯æ´é…ç½®åŠå¤–éƒ¨ npm å¥—ä»¶æ•´åˆï¼Œå¹«åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹ä¸¦æ“´å±•åŠŸèƒ½ã€‚'
language: zh-Hant-TW
images: ['/static/images/articles/jsii.png']
---

![jsii logo](/static/images/articles/jsii.png)

### ä»€éº¼æ˜¯ JSIIï¼Ÿ

JSII å…è¨±ä»»ä½•èªè¨€çš„ä»£ç¢¼èˆ‡ JavaScript é¡è‡ªç„¶åœ°é€²è¡Œäº’å‹•ã€‚é€™é …æŠ€è¡“ä½¿å¾— AWS Cloud Development Kit èƒ½å¤ å¾å–®ä¸€ä»£ç¢¼åº«ä¸­äº¤ä»˜å¤šèªè¨€æ”¯æ´çš„å‡½å¼åº«ï¼

ç”¨ TypeScript æ’°å¯«çš„é¡åˆ¥åº«ï¼Œä¸åƒ…å¯ä»¥åƒå¹³å¸¸ä¸€æ¨£ç”¨æ–¼ TypeScript æˆ– JavaScript çš„é …ç›®ä¸­ï¼Œé‚„èƒ½ç”¨æ–¼ Pythonã€Javaã€C#ï¼ˆä»¥åŠ .NET å®¶æ—ä¸­çš„å…¶ä»–èªè¨€ï¼‰ç­‰å¤šç¨®èªè¨€çš„é …ç›®ä¸­ã€‚

### å¿«é€Ÿä¸Šæ‰‹

#### ç’°å¢ƒæº–å‚™

1. **å®‰è£ Node.js**

åˆ° [Node.js å®˜æ–¹ç¶²ç«™](https://nodejs.org)ä¸‹è¼‰é©åˆä½ æ“ä½œç³»çµ±çš„å®‰è£åŒ…ã€‚

JSII æ”¯æ´ Node.js ç‰ˆæœ¬åŒ…å« ^18.0.0ï¼ˆæ”¯æ´è‡³ 2025 å¹´ 4 æœˆ 30 æ—¥ï¼‰ã€^20.0.0ï¼ˆæ”¯æ´è‡³ 2026 å¹´ 4 æœˆ 30 æ—¥ï¼‰ä»¥åŠ ^22.0.0ï¼ˆæ”¯æ´è‡³ 2027 å¹´ 4 æœˆ 30 æ—¥ï¼‰ã€‚

2. åœ¨é–‹ç™¼ **jsii æ¨¡çµ„** æ™‚ï¼Œå¿…é ˆç‚ºæ¯å€‹ç›®æ¨™èªè¨€å®‰è£å°æ‡‰çš„ SDKï¼Œæ‰èƒ½è®“ `jsii-pacmak` ç”Ÿæˆå¯ç™¼å¸ƒçš„ç”¢ç‰©ã€‚

- **.NET**ï¼šéœ€è¦ .NET 6.0 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚
- **Go**ï¼šéœ€è¦ Go 1.18 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚
- **Java**ï¼šéœ€è¦ JDK 8 æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œä¸¦ä¸”éœ€è¦ Maven 3.6 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚
- **Python**ï¼šéœ€è¦ Python 3.8 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚

#### å»ºç«‹å°ˆæ¡ˆ

```bash
mkdir jsii-demo
cd jsii-demo
npm init -y
```

#### æ–°å¢å¿…è¦çš„è³‡è¨Š

æ¥ä¸‹ä¾†ï¼Œè«‹åœ¨æ–°å‰µå»ºçš„ package.json æ–‡ä»¶ä¸­æ·»åŠ å¿…è¦çš„è³‡è¨Šã€‚å…·é«”è€Œè¨€ï¼Œjsii æ¨¡çµ„å¿…é ˆåŒ…å« author å’Œ repository çš„è¨­å®šï¼ˆé€™äº›è¨­å®šå°æ–¼æŸäº›åˆ†ç™¼å¹³å°ç”Ÿæˆæœ‰æ•ˆçš„å‡½å¼åº«æ˜¯å¿…éœ€çš„ï¼Œä¾‹å¦‚ Maven Centralï¼‰ã€‚

```json
{
   "name": "jsii-demo",
   "version": "1.0.0",
+  "description": "A demonstration jsii library",
   "main": "index.js",
   "scripts": {
     "test": "echo \"Error: no test specified\" && exit 1"
   },
   "keywords": [],
+  "author": {
+    "name": "KevinFan",
+    "email": "kevinypfan@gmail.com"
+  },
+  "repository": {
+    "url": "https://github.com/kevinypfan/jsii-demo.git"
+  },
   "license": "ISC"
}
```

#### è¨­å®š jsii é…ç½®

æœ€å¾Œï¼ŒåŸ·è¡Œ jsii-config æŒ‡ä»¤ï¼Œä¸¦æ ¹æ“šåŠ©æ‰‹çš„å¼•å°å®Œæˆé…ç½®éç¨‹ï¼š

```bash
npx jsii-config
? Target Languages python, dotnet
? Typescript config - should jsii generate a compatible tsconfig or do you want to manage it yourself
jsii-managed
? Jsii Stability - stability of compiled module apis experimental
? Jsii Type Definitions - compiled typescript definitions file for module index.d.ts
? Version Format - determines the format of the jsii toolchain version string that is included in the.jsii
assembly file's jsiiVersion attribute short
? Python Distname - PyPI distribution name for the package (e.g. "module-name.core") jsii_demo.core
? Python Module - name of the generated Python module (e.g. "module_name.core") jsii_demo.core
? .NET Namespace - root namespace under which types will be declared (e.g. "Amazon.Module") JsiiDemo.Core
? .NET Package Id - identifier of the package in the NuGet registry (e.g. "Amazon.Module") JsiiDemo.Core
? .NET Icon Url - optional url of the icon to be shown in the NuGet gallery (e.g.
"https://raw.githubusercontent.com/module-icon.png")
? .NET Version Suffix - optional suffix that will be appended at the end of the NuGet package's version field,
 must begin with a "-" (e.g. "-devpreview")
? Output Directory - Location for typescript compiler output dist
? Confirm Jsii Config
{
  "stability": "experimental",
  "types": "index.d.ts",
  "jsii": {
    "versionFormat": "short",
    "targets": {
      "python": {
        "distName": "jsii_demo.core",
        "module": "jsii_demo.core"
      },
      "dotnet": {
        "namespace": "JsiiDemo.Core",
        "packageId": "JsiiDemo.Core"
      }
    },
    "tsc": {
      "outDir": "dist"
    }
  }
}
Select no to revise Yes
Success!
```

#### å®‰è£ä¾è³´

æ¥è‘—å®‰è£ä¾è³´å¥—ä»¶

```bash
npm install --save-dev jsii jsii-pacmak
```

#### è¨­å®š package.json çš„ scripts

æœ€å¾Œï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨ package.json æ–‡ä»¶ä¸­é…ç½®ä¸€äº›æ–¹ä¾¿ä½¿ç”¨çš„è…³æœ¬ï¼Œä»¥ä¾¿æ–¼ç®¡ç†å’Œæ“ä½œæ‚¨çš„é …ç›®ï¼š

```json
{
   "name": "jsii-demo",
   "version": "1.0.0",
   "description": "A demonstration jsii library",
   "main": "index.js",
   "scripts": {
+    "build": "jsii",
+    "build:watch": "jsii --watch",
+    "package": "jsii-pacmak"
   },
   // ...
}
```

#### é–‹å§‹æ’°å¯«ç¨‹å¼

å»ºç«‹ä¸€å€‹æ–°çš„ `index.ts` æª”æ¡ˆèˆ‡ç°¡å–®çš„ç¨‹å¼ï¼š

```javascript
export interface GreeterProps {
  readonly greetee: string;
}

export class Greeter {
  private readonly greetee: string;

  public constructor(props: GreeterProps) {
    this.greetee = props.greetee;
  }

  public greet(): string {
    return `Hello, ${this.greetee}!`;
  }
}
```

é€™æ™‚å˜—è©¦ build typescript æ™‚æœƒçœ‹åˆ°éŒ¯èª¤

```bash
npm run build

> jsii-demo@1.0.0 build
> jsii

[2025-01-04T17:13:04.604] [ERROR] jsii/compiler - Type model errors prevented the JSII assembly from being created
error JSII4: Could not find "main" file: /Users/zackfan/Project/dummy/index.ts
warning JSII3: There is no "README.md" file. It is required in order to generate valid PyPI (Python) packages.
```

ä¿®å¾©éŒ¯èª¤éœ€è¦åœ¨ç›®éŒ„ä¸‹ç”¢ç”Ÿ `README.md` æª”æ¡ˆ

```bash
touch README.md
```

ç„¶å¾Œä¿®æ”¹ä¸€äº› package.json çš„å±¬æ€§ï¼Œä¸¦åœ¨ jsii è£¡åŠ ä¸Š outdir ä½ç½®

```json
{
  "name": "jsii-demo",
  "version": "1.0.0",
  "description": "A demonstration jsii library",
-  "main": "index.js",
+  "main": "dist/index.js",
  "scripts": {
    "build": "jsii",
    "build:watch": "jsii --watch",
    "package": "jsii-pacmak"
  },
  "keywords": [],
  "author": {
    "name": "KevinFan",
    "email": "kevinypfan@gmail.com"
  },
  "repository": {
    "url": "https://github.com/kevinypfan/jsii-demo.git"
  },
  "license": "ISC",
  "stability": "experimental",
- "types": "index.d.ts",
+  "types": "dist/index.d.ts",
  "jsii": {
+    "outdir": "targets",
    "versionFormat": "short",
    "targets": {
      "python": {
        "distName": "jsii_demo.core",
        "module": "jsii_demo.core"
      },
      "dotnet": {
        "namespace": "JsiiDemo.Core",
        "packageId": "JsiiDemo.Core"
      }
    },
    "tsc": {
      "outDir": "dist"
    }
  },
  "devDependencies": {
    "jsii": "^5.7.4",
    "jsii-pacmak": "^1.106.0"
  }
}
```

æ¥ä¸‹ä¾†å°±å¯ä»¥åŸ·è¡Œæ‰“åŒ…æµç¨‹å•¦ `build` -> `package`

```
npm run build

> jsii-demo@1.0.0 build
> jsii

npm run package

> jsii-demo@1.0.0 package
> jsii-pacmak
```

å¥—ä»¶æœƒç”¢ç”Ÿåœ¨ targets è³‡æ–™å¤¾

```
tree targets
targets
â”œâ”€â”€ dotnet
â”‚   â”œâ”€â”€ JsiiDemo.Core.1.0.0.nupkg
â”‚   â””â”€â”€ JsiiDemo.Core.1.0.0.snupkg
â”œâ”€â”€ js
â”‚   â””â”€â”€ jsii-demo@1.0.0.jsii.tgz
â””â”€â”€ python
    â”œâ”€â”€ jsii_demo.core-1.0.0-py3-none-any.whl
    â””â”€â”€ jsii_demo_core-1.0.0.tar.gz

4 directories, 5 files
```

#### ä½¿ç”¨ python åŸ·è¡Œå‰›å‰› build å‡ºä¾†çš„å¥—ä»¶

å› ç‚ºæˆ‘å€‹äººæ¯”è¼ƒç†Ÿæ‚‰ python æ‰€ä»¥ç”¨æ­¤å±•ç¤ºæˆæœã€‚

å»ºç«‹è™›æ“¬ python ç’°å¢ƒï¼Œé¿å…å—æœ¬åœ°ç’°å¢ƒå½±éŸ¿

```bash
python -m venv .venv
source .venv/bin/activate
```

å®‰è£å‰›å‰› build å‡ºä¾†çš„å¥—ä»¶

```bash
pip install targets/python/jsii_demo.core-1.0.0-py3-none-any.whl
```

å»ºç«‹ test.py æ¸¬è©¦å¥—ä»¶é‹è¡Œ

```python
from jsii_demo.core import Greeter

greeter = Greeter(greetee="Kevin")

print(greeter.greet()) # Output: Hello, Kevin!
```

#### å¦‚ä½•åœ¨ jsii ä½¿ç”¨ npm å¥—ä»¶å‘¢ï¼Ÿ

ç‚ºäº†è®“æˆ‘å€‘ print å‡ºä¾†çš„è³‡è¨Šæ›´ç”Ÿå‹•ï¼Œæˆ‘å€‘ä½¿ç”¨ [figlet](https://www.npmjs.com/package/figlet) ä¾†å°å‡ºè³‡è¨Šã€‚

é¦–å…ˆä½¿ç”¨ npm å®‰è£å¥—ä»¶

```bash
npm add figlet
npm add -D @types/figlet
```

æ¥ä¸‹ä¾†è¨˜å¾—åœ¨ pachage.json çš„ bundledDependencies åŠ ä¸Š figlet

```json
{
  "name": "jsii-demo",
  "version": "1.0.0",
  "description": "A demonstration jsii library",
  "main": "dist/index.js",
  // ...
  "devDependencies": {
    "@types/figlet": "^1.7.0",
    "jsii": "^5.7.4",
    "jsii-pacmak": "^1.106.0"
  },
  "dependencies": {
    "figlet": "^1.8.0"
  },
+    "bundledDependencies": [
+    "figlet"
+  ]
}
```

ä¿®æ”¹æˆ‘å€‘çš„ index.ts æª”æ¡ˆï¼Œæ–°å¢ prettyGreet function

```typescript
import * as figlet from "figlet";

export class Greeter {
  // ...
  public prettyGreet(): string {
    return figlet.textSync(`Hello, ${this.greetee}!`, {
      font: "Ghost",
      horizontalLayout: "default",
      verticalLayout: "default",
      width: 80,
      whitespaceBreak: true,
    });
  }
}
```

é‡æ–°ç”¨ npm åŸ·è¡Œ build èˆ‡ package ä¸¦ä½¿ç”¨ pip é‡å®‰è£ python wheel æª”æ¡ˆ

```bash
npm run build && npm run package
pip install --force-reinstall targets/python/jsii_demo.core-1.0.0-py3-none-any.whl
```

ä¿®æ”¹ test.py æª”æ¡ˆï¼Œä½¿ç”¨ prety_greet å°å‡ºè³‡è¨Š
```python
from jsii_demo.core import Greeter

greeter = Greeter(greetee="Kevin")

print(greeter.pretty_greet())
#  ('-. .-.   ('-.                                          
# ( OO )  / _(  OO)                                         
# ,--. ,--.(,------.,--.      ,--.      .-'),-----.         
# |  | |  | |  .---'|  |.-')  |  |.-') ( OO'  .-.  '        
# |   .|  | |  |    |  | OO ) |  | OO )/   |  | |  |        
# |       |(|  '--. |  |`-' | |  |`-' |\_) |  |\|  |        
# |  .-.  | |  .--'(|  '---.'(|  '---.'  \ |  | |  |        
# |  | |  | |  `---.|      |  |      |    `'  '-'  '.-.     
# `--' `--' `------'`------'  `------'      `-----' ',/     
# .-. .-')     ('-.        (`-.                .-') _ ,---. 
# \  ( OO )  _(  OO)     _(OO  )_             ( OO ) )|   | 
# ,--. ,--. (,------.,--(_/   ,. \ ,-.-') ,--./ ,--,' |   | 
# |  .'   /  |  .---'\   \   /(__/ |  |OO)|   \ |  |\ |   | 
# |      /,  |  |     \   \ /   /  |  |  \|    \|  | )|   | 
# |     ' _)(|  '--.   \   '   /,  |  |(_/|  .     |/ |  .' 
# |  .   \   |  .--'    \     /__),|  |_.'|  |\    |  `--'  
# |  |\   \  |  `---.    \   /   (_|  |   |  | \   |  .--.  
# `--' '--'  `------'     `-'      `--'   `--'  `--'  '--' 
```

å¤§åŠŸå‘Šæˆï¼æˆåŠŸåœ¨ python ç’°å¢ƒåŸ·è¡Œ TypeScript ç¨‹å¼å›‰ ğŸ‰

### çµè«–

é€é JSIIï¼Œæˆ‘å€‘å¯ä»¥è¼•é¬†åœ°å°‡ä»¥ TypeScript æ’°å¯«çš„ Library ç™¼å¸ƒåˆ°å¤šç¨®èªè¨€çš„ç”Ÿæ…‹ç³»çµ±ä¸­ï¼Œä¸¦ä¸”ä¿æœ‰ä¸€è‡´çš„åŠŸèƒ½èˆ‡ä½¿ç”¨é«”é©—ã€‚é€™é …å·¥å…·å°æ–¼éœ€è¦è·¨èªè¨€æ”¯æ´çš„å°ˆæ¡ˆå°¤å…¶é‡è¦ï¼Œä¾‹å¦‚ AWS CDK çš„æ‡‰ç”¨å ´æ™¯ã€‚é€éæœ¬æ–‡çš„å¯¦éš›æ“ä½œæµç¨‹ï¼Œæˆ‘å€‘å±•ç¤ºäº†å¦‚ä½•åœ¨ TypeScript ä¸­å»ºæ§‹ Library ä¸¦æˆåŠŸåœ¨ Python ç’°å¢ƒä¸­ä½¿ç”¨å®ƒï¼Œé€²ä¸€æ­¥çµåˆäº†å¤–éƒ¨ npm å¥—ä»¶ä¾†å¢å¼·åŠŸèƒ½è¡¨ç¾ã€‚

JSII ä¸åƒ…æä¾›äº†æŠ€è¡“ä¸Šçš„å¯è¡Œæ€§ï¼Œæ›´ç‚ºè·¨èªè¨€é–‹ç™¼çš„é«˜æ•ˆæ€§èˆ‡ä¸€è‡´æ€§æ‰“ä¸‹äº†åŸºç¤ã€‚å°æ–¼æƒ³è¦æ“´å±•é–‹ç™¼æˆæœåˆ°æ›´å¤šèªè¨€é–‹ç™¼è€…çš„åœ˜éšŠï¼ŒJSII æ˜¯ä¸€å€‹å¼·å¤§çš„é¸æ“‡ã€‚

Demo Repo: [GitHub Repository](https://github.com/kevinypfan/jsii-demo)

æ­¡è¿ç€è¦½ä¸¦è©¦ç”¨ï¼Œè‹¥æœ‰ä»»ä½•å•é¡Œæˆ–å»ºè­°ï¼Œæ­¡è¿æå‡º Issue æˆ–ç•™è¨€åˆ†äº«æ‚¨çš„ä½¿ç”¨å¿ƒå¾—ï¼
